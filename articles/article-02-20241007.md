---
title: "ã€IRON CTFã€‘Write Up"
emoji: "ğŸˆ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["CTF"]
published: false
---

# ã¯ã˜ã‚ã«
2024å¹´ã®10æœˆ5æ—¥ã‹ã‚‰10æœˆ6æ—¥ã«ã‚ãŸã£ã¦24æ™‚é–“ã§é–‹å‚¬ã•ã‚ŒãŸ[IRON CTF](https://ctf.1nf1n1ty.team/)ã®Write up ã§ã™ï¼

![](/images/02/ironctf_result.png =250x)

1671ptã§ï¼Œ169ä½ã§ã—ãŸï¼

# å•é¡Œãƒªã‚¹ãƒˆ
[Dantig's Puzzle - Crypto](#dantigs-puzzle---crypto)
[Game of Hunt - Forensics](#game-of-hunt---forensics)
ã“ã®ã»ã‹ï¼Œåˆ¥ã®æ–¹ã®Write upã‚’å‚è€ƒã«ã—ã¦ï¼Œå¾Œæ—¥è§£ã„ã¿ãŸå•é¡Œã«é–¢ã™ã‚‹è¨˜äº‹ã‚‚æ›¸ãäºˆå®šã§ã™ï¼

# Write ups
## Dantig's Puzzle - Crypto
### å•é¡Œæ–‡
> Dantzig was on a trip with his friends and one day, they decided to play a game or atleast, it's easier version. He would think of a string and the others have to find it based on the clues he gives them.
>
> 1. The knapsack list contains 8 numbers, with 1 and 2 as the first two numbers and the subsequent numbers are formed by adding one to the sum of all the numbers before.
> 2. The value of m=257 and n is something less than 257
> 3. The encrypted string is - [538, 619, 944, 831, 360, 531, 468, 971, 635, 593, 655, 425, 1068, 530, 1068, 360, 706, 1068, 299, 619, 670, 1068, 891, 425, 670, 1068, 371, 670, 732, 531, 1068, 484, 372, 635, 371, 372, 237, 237, 1007]
>
> Can you find the string Dantzig was thinking of?
>
> Flag Format: ironCTF{this_is_fake}
> Author: p3rplex3d

### è§£æ³•
ã€ŒDantzigã€ï¼Œã€ŒKnapsackã€ãªã©ã®å˜èªã§ã‚°ã‚°ã‚‹ã¨ã€ŒãƒŠãƒƒãƒ—ã‚¶ãƒƒã‚¯æš—å·ã€ãŒé–¢é€£ã—ã¦ã„ã‚‹ã¨ã‚ã‹ã‚Šã¾ã™ï¼

https://ja.wikipedia.org/wiki/Merkle-Hellman%E3%83%8A%E3%83%83%E3%83%97%E3%82%B5%E3%83%83%E3%82%AF%E6%9A%97%E5%8F%B7

å¾©å·ã«ã¯å…¬é–‹éµã§ã‚ã‚‹$\beta$ã¨å…±é€šéµã§ã‚ã‚‹$w, q, r$ãŒå¿…è¦ã¨åˆ†ã‹ã‚Šã¾ã™ï¼

wikiã®è¨˜è¿°ã¨å•é¡Œæ–‡ã‚’ç…§ã‚‰ã—åˆã‚ã›ã‚‹ã¨

* $n(=8)$ãƒ“ãƒƒãƒˆã®ãƒ‡ãƒ¼ã‚¿ã®åˆ—ã‚’æš—å·åŒ–ã—ã¦ã„ã‚‹
* ã€ŒKnapsack listã€ãŒè¶…å¢—åŠ åˆ—$w$
* ç§˜å¯†éµ$q = 257$ (å•é¡Œæ–‡ä¸­ã®$m$)

ã§ã‚ã‚‹ã¨æ¨æ¸¬ã§ãã¾ã™ï¼

ç§˜å¯†éµã§ã‚ã‚‹$r$ãŒä¸ãˆã‚‰ã‚Œã¦ã„ã¾ã›ã‚“ï¼ã—ã‹ã—ï¼Œ$\mathrm{gcd}(q, r)=1$ã¨ã„ã†åˆ¶ç´„ã‹ã‚‰ï¼Œ$r$ã®å€™è£œã¯256é€šã‚Šã—ã‹ãªã„ã¨ã‚ã‹ã‚Šã¾ã™ï¼ã“ã®ãŸã‚ï¼Œ$r$ã®ã™ã¹ã¦ã®å€™è£œã«ã¤ã„ã¦å¾©å·ã‚’è©¦ã¿ã‚Œã°ã‚ˆã„ã§ã™ï¼ã¾ãŸï¼Œå…¬é–‹éµã§ã‚ã‚‹$\beta$ã¯$r$ã¨è¶…å¢—åŠ åˆ—$w$ã‹ã‚‰è¨ˆç®—ã§ãã¾ã™ï¼

ã“ã‚Œã‚’å®Ÿè£…ã—ã¾ã™ï¼

````python
def gen_cdash(c, rinv, q):
	cdash = []
	for ci in c:
		cdash.append((ci * rinv) % q)
	return cdash

def decrypt(w, cdash, n):
	message = []
	for s in cdash:
		S = 0
		for i in range(n-1, -1, -1):
			if s >= w[i]:
				s = s - w[i]
				S = S | (1 << (n - 1 - i))
		message.append(S)
	return message

# knapsack list è¶…å¢—åŠ åˆ—
w = [1, 2, 4, 8, 16, 32, 64, 128]
# ç§˜å¯†éµ q
q = 257
# n: 8ãƒ“ãƒƒãƒˆã®å¹³æ–‡ã‚’æš—å·åŒ–ã™ã‚‹
n = 8

# æš—å·æ–‡
c = [538, 619, 944, 831, 360, 531, 468, 971, 635, 593, 655, 425, 1068, 530, 1068, 360, 706, 1068, 299, 619, 670, 1068, 891, 425, 670, 1068, 371, 670, 732, 531, 1068, 484, 372, 635, 371, 372, 237, 237, 1007]

# rã®å€™è£œã‚’å…¨ã¦è©¦ã™
for r in range(1, q):
    rinv = pow(r, -1, q)
    cdash = gen_cdash(c, rinv, q)
    message = decrypt(w, cdash, n)
    # å¾—ã‚‰ã‚ŒãŸæ–‡å­—åˆ—ã®ã†ã¡ï¼Œasciiã§èª­ã¿å–ã‚Œã‚‹ã‚‚ã®ã‚’å‡ºåŠ›ã™ã‚‹
    if all([0x00 <= m <= 0x7f for m in message]):
		print(''.join([chr(m) for m in message]))
````
å¾—ã‚‰ã‚ŒãŸå¹³æ–‡ã‚’asciiã§å¤‰æ›ã™ã‚‹ã¨ï¼ŒflagãŒå¾—ã‚‰ã‚Œã¾ã—ãŸï¼

````
ironCTF{M4th_&_C5_ar3_7h3_b3sT_c0Mb0!!}
````

## Game of Hunt - Forensics
### å•é¡Œæ–‡
> A Cryptic Voyage
> Author: tasarmays

ã¾ãŸï¼Œ`upsidedown.txt`ã¨ã„ã†ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãŒä¸ãˆã‚‰ã‚Œã¾ã™ï¼

````:upsidedown.txt(ä¸€éƒ¨)
00000000 00000000 00000000 00000001 01000001 ...
````
`upsidedown.txt`ã§ã¯ï¼ŒäºŒé€²æ–‡å­—åˆ—ãŒã‚¹ãƒšãƒ¼ã‚¹åŒºåˆ‡ã‚Šã§ç¾…åˆ—ã•ã‚Œã¦ã„ã¾ã™ï¼ãƒ•ã‚¡ã‚¤ãƒ«åã§ã‚ã‚‹ã€Œupsidedownã€ã¨ã„ã†å˜èªã‚’ãƒ’ãƒ³ãƒˆã«ï¼Œã“ã®ãƒªã‚¹ãƒˆã‚’åè»¢ã—ã¦è¡¨ç¤ºã—ã¦ã¿ã¾ã™ï¼äºŒé€²æ•°ã®ã¾ã¾ã ã¨ã¿ãšã‚‰ã„ã®ã§16é€²æ•°ã«å¤‰æ›ã—ã¦ã„ã¾ã™ï¼
````python
s = []
with open("upsidedown.txt", "r") as f:
	s = f.read().split(" ")

s = [int(i, 2) for i in s]
s_hex = [hex(i) for i in s]

print(s_hex[::-1][:5])
````
ã“ã‚Œã‚’å®Ÿè¡Œã™ã‚‹ã¨
````
['0x50', '0x4b', '0x3', '0x4', '0xa']
````
ã¨ãªã‚Šã¾ã™ï¼
`0x50`ï¼Œ`0x4b`ï¼Œ`0x03`ï¼Œ... ã¨ã„ã†ãƒã‚¤ãƒˆåˆ—ã¯ï¼Œzipãƒ•ã‚¡ã‚¤ãƒ«ã®å†’é ­ã®ãƒã‚¤ãƒˆåˆ—ã¨ä¸€è‡´ã—ã¾ã™ï¼

https://en.wikipedia.org/wiki/List_of_file_signatures

ãƒã‚¤ãƒˆåˆ—ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã¿ï¼Œ`upsidedown.zip`ã¨ã—ã¦ä¿å­˜ã—ã¾ã™ï¼

````python
s = []
with open("upsidedown.txt", "r") as f:
	s = f.read().split(" ")

with open("upsidedown.zip", "wb") as f:
	f.write(bytes(reversed(s)))
````
å¾—ã‚‰ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’unzipã™ã‚‹ã¨ï¼Œ`ilovepdfs/`ã¨ã„ã†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å…¥ã£ãŸå¤§é‡ã®pdfãŒå¾—ã‚‰ã‚Œã¾ã™ï¼
````bash
$ ls -r ilovepdfs/
document_99.pdf  document_88.pdf  document_77.pdf  document_66.pdf  document_55.pdf  document_44.pdf  document_33.pdf  document_22.pdf  document_11.pdf
document_98.pdf  document_87.pdf  document_76.pdf  document_65.pdf  document_54.pdf  document_43.pdf  document_32.pdf  document_21.pdf  document_100.pdf   
document_97.pdf  document_86.pdf  document_75.pdf  document_64.pdf  document_53.pdf  document_42.pdf  document_31.pdf  document_20.pdf  document_10.pdf    
document_96.pdf  document_85.pdf  document_74.pdf  document_63.pdf  document_52.pdf  document_41.pdf  document_30.pdf  document_2.pdf   document_1.pdf     
document_95.pdf  document_84.pdf  document_73.pdf  document_62.pdf  document_51.pdf  document_40.pdf  document_3.pdf   document_19.pdf
document_94.pdf  document_83.pdf  document_72.pdf  document_61.pdf  document_50.pdf  document_4.pdf   document_29.pdf  document_18.pdf
document_93.pdf  document_82.pdf  document_71.pdf  document_60.pdf  document_5.pdf   document_39.pdf  document_28.pdf  document_17.pdf
document_92.pdf  document_81.pdf  document_70.pdf  document_6.pdf   document_49.pdf  document_38.pdf  document_27.pdf  document_16.pdf
document_91.pdf  document_80.pdf  document_7.pdf   document_59.pdf  document_48.pdf  document_37.pdf  document_26.pdf  document_15.pdf
document_90.pdf  document_8.pdf   document_69.pdf  document_58.pdf  document_47.pdf  document_36.pdf  document_25.pdf  document_14.pdf
document_9.pdf   document_79.pdf  document_68.pdf  document_57.pdf  document_46.pdf  document_35.pdf  document_24.pdf  document_13.pdf
document_89.pdf  document_78.pdf  document_67.pdf  document_56.pdf  document_45.pdf  document_34.pdf  document_23.pdf  document_12.pdf
````
å¤§åŠã®pdfã¯æ¬¡ã®ã‚ˆã†ãªæ„å‘³ã®ãªã„ã‚‚ã®ã§ã™ï¼
![](/images/02/ilovepdfs.png)
ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ç›®ã‚’é€šã™ã¨ï¼Œ`document_83.pdf`ã«æ¬¡ã®æ‰‹ãŒã‹ã‚ŠãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼

[ã“ã¡ã‚‰](https://abuctf.github.io/posts/IronCTF/#game-of-hunt)ã®Write upã«ã‚ˆã‚‹ã¨ï¼Œpdf2txtã¨ã„ã†ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã†ã¨ä¾¿åˆ©ãªã‚ˆã†ã§ã™ï¼
````bash
$ find . -type f -name "*.pdf" | xargs -I {} pdf2txt {}
````
å®Ÿè¡Œçµæœ(æŠœç²‹)
````
This is PDF document 82


How do you feel now, find the hidden esolang :)  

++++++++++[>+>+++>+++++++>++++++++++<<<<-]>>>>+++++.++++++++
+.---.-.<---.+++++++++++++++++.--------------.>+++++++++++++.<+++++++++++++++++
++.>------------.+++++
+.<++++++.++.>---.<++++.------.>++.<+++++++++.---.------.+++++++.+
++.+++++.---------.>-.
+.+++++++++.



This is PDF document 84

````
brainf*ckã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãŒä¸ãˆã‚‰ã‚Œã¦ã„ã¾ã™ï¼ã“ã‚Œã‚’å®Ÿè¡Œã™ã‚‹ã¨flagãŒå¾—ã‚‰ã‚Œã¾ã—ãŸï¼è‡ªåˆ†ã¯[ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©](https://www.tutorialspoint.com/execute_brainfk_online.php)ã‚’ä½¿ç”¨ã—ã¾ã—ãŸï¼
````
++++++++++[>+>+++>+++++++>++++++++++<<<<-]>>>>+++++.++++++++
+.---.-.<---.+++++++++++++++++.--------------.>+++++++++++++.<+++++++++++++++++
++.>------------.+++++
+.<++++++.++.>---.<++++.------.>++.<+++++++++.---.------.+++++++.+
++.+++++.---------.>-.
+.+++++++++.
````
å®Ÿè¡Œçµæœ:
````
ironCTF{You_are_the_finest}
````