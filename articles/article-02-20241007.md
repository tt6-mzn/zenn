---
title: "ã€IRON CTFã€‘Write Ups"
emoji: "ðŸˆ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["CTF"]
published: false
---

# ã¯ã˜ã‚ã«
2024å¹´ã®10æœˆ5æ—¥ã‹ã‚‰10æœˆ6æ—¥ã«ã‚ãŸã£ã¦24æ™‚é–“ã§é–‹å‚¬ã•ã‚ŒãŸ[IRON CTF](https://ctf.1nf1n1ty.team/)ã®Write up ã§ã™ï¼Ž

![](/images/02/ironctf_result.png =250x)

1671ptã§ï¼Œ169ä½ã§ã—ãŸï¼Ž

# Write ups
## Dantig's Puzzle - Crypto
### å•é¡Œæ–‡
> Dantzig was on a trip with his friends and one day, they decided to play a game or atleast, it's easier version. He would think of a string and the others have to find it based on the clues he gives them.
>
> 1. The knapsack list contains 8 numbers, with 1 and 2 as the first two numbers and the subsequent numbers are formed by adding one to the sum of all the numbers before.
> 2. The value of m=257 and n is something less than 257
> 3. The encrypted string is - [538, 619, 944, 831, 360, 531, 468, 971, 635, 593, 655, 425, 1068, 530, 1068, 360, 706, 1068, 299, 619, 670, 1068, 891, 425, 670, 1068, 371, 670, 732, 531, 1068, 484, 372, 635, 371, 372, 237, 237, 1007]
>
> Can you find the string Dantzig was thinking of?
>
> Flag Format: ironCTF{this_is_fake}
> Author: p3rplex3d

### è§£æ³•
ã€ŒDantzigã€ï¼Œã€ŒKnapsackã€ãªã©ã®å˜èªžã§ã‚°ã‚°ã‚‹ã¨ã€ŒãƒŠãƒƒãƒ—ã‚¶ãƒƒã‚¯æš—å·ã€ãŒé–¢é€£ã—ã¦ã„ã‚‹ã¨ã‚ã‹ã‚Šã¾ã™ï¼Ž

https://ja.wikipedia.org/wiki/Merkle-Hellman%E3%83%8A%E3%83%83%E3%83%97%E3%82%B5%E3%83%83%E3%82%AF%E6%9A%97%E5%8F%B7

å¾©å·ã«ã¯å…¬é–‹éµã§ã‚ã‚‹$\beta$ã¨å…±é€šéµã§ã‚ã‚‹$w, q, r$ãŒå¿…è¦ã¨åˆ†ã‹ã‚Šã¾ã™ï¼Ž

wikiã®è¨˜è¿°ã¨å•é¡Œæ–‡ã‚’ç…§ã‚‰ã—åˆã‚ã›ã‚‹ã¨

* $n(=8)$ãƒ“ãƒƒãƒˆã®ãƒ‡ãƒ¼ã‚¿ã®åˆ—ã‚’æš—å·åŒ–ã—ã¦ã„ã‚‹
* ã€ŒKnapsack listã€ãŒè¶…å¢—åŠ åˆ—$w$
* ç§˜å¯†éµ$q = 257$ (å•é¡Œæ–‡ä¸­ã®$m$)

ã§ã‚ã‚‹ã¨æŽ¨æ¸¬ã§ãã¾ã™ï¼Ž

ç§˜å¯†éµã§ã‚ã‚‹$r$ãŒä¸Žãˆã‚‰ã‚Œã¦ã„ã¾ã›ã‚“ï¼Žã—ã‹ã—ï¼Œ$\mathrm{gcd}(q, r)=1$ã¨ã„ã†åˆ¶ç´„ã‹ã‚‰ï¼Œ$r$ã®å€™è£œã¯256é€šã‚Šã—ã‹ãªã„ã¨ã‚ã‹ã‚Šã¾ã™ï¼Žã“ã®ãŸã‚ï¼Œ$r$ã®ã™ã¹ã¦ã®å€™è£œã«ã¤ã„ã¦å¾©å·ã‚’è©¦ã¿ã‚Œã°ã‚ˆã„ã§ã™ï¼Žã¾ãŸï¼Œå…¬é–‹éµã§ã‚ã‚‹$\beta$ã¯$r$ã¨è¶…å¢—åŠ åˆ—$w$ã‹ã‚‰è¨ˆç®—ã§ãã¾ã™ï¼Ž

ã“ã‚Œã‚’å®Ÿè£…ã—ã¾ã™ï¼Ž

````python
def gen_cdash(c, rinv, q):
	cdash = []
	for ci in c:
		cdash.append((ci * rinv) % q)
	return cdash

def decrypt(w, cdash, n):
	message = []
	for s in cdash:
		S = 0
		for i in range(n-1, -1, -1):
			if s >= w[i]:
				s = s - w[i]
				S = S | (1 << (n - 1 - i))
		message.append(S)
	return message

# å…¬é–‹éµ: beta
# ç§˜å¯†éµ: w, q, r(åˆ†ã‹ã£ã¦ãªã„)
# å•é¡Œæ–‡ã©ãŠã‚Šã«å®Ÿè£…ã™ã‚‹ã¨ã“ã‚ŒãŒå¾—ã‚‰ã‚Œã‚‹
w = [1, 2, 4, 8, 16, 32, 64, 128]
q = 257
# n: 8ãƒ“ãƒƒãƒˆã®å¹³æ–‡ã‚’æš—å·åŒ–ã™ã‚‹
n = 8

c = [538, 619, 944, 831, 360, 531, 468, 971, 635, 593, 655, 425, 1068, 530, 1068, 360, 706, 1068, 299, 619, 670, 1068, 891, 425, 670, 1068, 371, 670, 732, 531, 1068, 484, 372, 635, 371, 372, 237, 237, 1007]

# rã®å€™è£œã‚’å…¨ã¦è©¦ã™
for r in range(1, q):
    rinv = pow(r, -1, q)
    cdash = gen_cdash(c, rinv, q)
    message = decrypt(w, cdash, n)
    # å¾—ã‚‰ã‚ŒãŸæ–‡å­—åˆ—ã®ã†ã¡ï¼Œasciiã§èª­ã¿å–ã‚Œã‚‹ã‚‚ã®ã‚’å‡ºåŠ›ã™ã‚‹
    if all([0x00 <= m <= 0x7f for m in message]):
		print(''.join([chr(m) for m in message]))
````
å¾—ã‚‰ã‚ŒãŸå¹³æ–‡ã‚’asciiã§å¤‰æ›ã™ã‚‹ã¨ï¼ŒflagãŒå¾—ã‚‰ã‚Œã¾ã—ãŸï¼Ž

````
ironCTF{M4th_&_C5_ar3_7h3_b3sT_c0Mb0!!}
````