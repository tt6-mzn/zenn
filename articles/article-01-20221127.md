---
title: "三項間漸化式の一般項の求め方(差分方程式つまみぐい)"
emoji: "👋"
type: "tech"
topics:
  - "数学"
published: false
---

# 初めに

## この記事の概要

高校で学習する三項間漸化式のちょっと変わった(?)解法を紹介します。具体的には、次の漸化式で表される数列$\{x_n\}_{n=1,2,3,...}$の一般項を求める方法を紹介します。

$$
x_{n + 2} + p x_{n + 1} + q x_n = 0 \quad (q \neq 0) \tag{1}
$$

多くの高校生向けの教科書やWeb記事では、特性方程式とよばれる二次方程式$\lambda ^2 + p\lambda + q = 0$の解を利用して式(1)を書き換えることで一般項を求める方法が紹介されています。この解法は明快ではあります。しかし、発想にかなりの飛躍があり、納得はしても、同じ方法を使って後から自力で一般項を導出することはかなり難しいと言えます。

本記事では、できるだけ発想を飛躍させることなく、文脈に沿って一般項を求める方法を紹介します(多分)。とくに、本記事で紹介した考え方を用いることで、後からでも自力で一般項を導出することができるように意識して解説します(したい)。
また、一般項を求めるために、差分方程式の非常に基本的な概念を導入します。筆者は完全な差分方程式にわかですが、面白い分野だと感じているので、本記事を通して多くの人に「そんな分野もあるんだなぁ」と知っていただけると嬉しいです。

## 対象読者

三項間漸化式を勉強したけど、特性方程式とか、その解を使った式変形に発想の飛躍を感じてしまっている高校生や高専生を意識した記事になっています。また、今回紹介する解法は、とある微分方程式の解法と関連があります。微分方程式を知っている読者は、本記事でカタルシスを感じることができるかもしれません。

## 保身

本記事は、共立出版、広田良悟先生と高橋大輔先生の、『差分と超離散』という書籍のほんの一部を、数学にわかの筆者が魔翻訳し、うすめたものとなっています。誤りが含まれることが無いよう努力しましたが、厳密性は欠かれているものとしてお読みください。正確な議論が知りたい場合には、実際の書籍を確認してください。書籍へのリンクを張っておきます。

https://www.kyoritsu-pub.co.jp/book/b10011204.html

なお、筆者が本記事の作成にあたって参考にしたのは初版第7刷(2020)、p16からp26のあたりです。

# 準備

まずは問題を整理しつつ、用語を導入します。

## 問題を眺める

式(1)を再掲します。

$$
x_{n + 2} + p x_{n + 1} + q x_n = 0 \quad (q \neq 0) \tag{1}
$$

求めたいのは、式(1)に示した漸化式を満たす数列$\{x_n\}_{n=1,2,3,...}$の一般項です。このような数列$\{x_n\}_{n=1,2,3,...}$を、式(1)の**解**と呼ぶことにします。

式(1)で$q \neq 0$となっているのは、「式(1)は三項間漸化式である」という仮定があるからです。もし$q = 0$であると、式(1)は、

$$
x_{n + 2} + p x_{n + 1} = 0 \tag{2}
$$

となり、二項間漸化式となってしまいます。問題としたいのは三項間漸化式ですから、$q \neq 0$という仮定が置かれているわけです。
ちなみに、$p$は$0$でもよいです。$p = 0$のとき、式(1)は、

$$
x_{n + 2} + q x_{n} = 0 \tag{3}
$$

になります。こちらは式(2)とちがって、隣り合っていない二つの項の間の関係を表しています。これも三項間漸化式の一種と考えます。

## 解は無数にある

さて、式(1)の解を求めたいわけですから、式(1)を満たす数列の一般項を、関数$f(n)$を用いて、

$$
x_n = f(n) \tag{4}
$$

のようにあらわすことができればOKです......といいたいところですが、そう単純には行きません。
実は、式(1)は無数の解をもちます。式(1)だけでは条件が弱く、それを満たす数列が無限に出てきてしまうのです。したがって、式(4)のように、$x_n$を一つの関数の形で書くことはできません(かけたとしても、それは式(1)の解のうち一つを表したにすぎません)。本記事で問題にしたいのは、なんとかして、式(1)を満たすすべての解をまとめて表すことはできないか、ということです。この、一見困難な問題を解決するために、式(1)にほかにどんな条件を追加すれば、それを満たす解を一つに決めることができるかを考えてみます。

## 解を一つに決めるには？

式(1)を満たす、という条件のほかにどんな条件を追加すれば、その解を一つに決めることができるでしょうか。おそらく一番簡単な方法は、第1項と第2項の値を決めてしまうことです。
第1項の値$x_1$と、第2項の値$x_2$を何らかの値に決めてしまったとします。このとき、式(1)から、

$$
x_3 = - px_2 -qx_1 \tag{5}
$$

のように第3項の値を決めることができます。同様に、$x_3$、$x_2$の値と式(1)から、第4項である$x_4$の値も決めることができます。これを繰り返せば、数列のどの項の値も求めることができます。すなわち、「$x_1$と$x_2$の値が決まっている」という条件の下で、式(1)を満たす数列はただ一つに決まります。
この「$x_1$と$x_2$の値が決まっている」という条件を、式(1)の**初期条件**といいます。初期条件を決めると式(1)の解は一つに定まる、というわけです。
逆に、式(1)を満たす解が1つ見つかったとします。その第1項と第2項を見た時、例えば$x_1=1$、$x_2=2$であったとしたら、「この解は初期条件$x_1=1$、$x_2=2$の下での式(1)の解である」とわかります。
要するに、次のことが言えます。

----

第1項の値と第2項の値は、式(1)の解と1対1対応する。すなわち、式(1)のすべての解の一般項は、

$$
x_n = f(n, x_1, x_2) \tag{6}
$$

の形に表すことができる。

----

ところで、わかりやすく第1項と第2項の値を決めてもよいですが、かわりに第2項と第3項の値を決めても、式(1)の解は一つに定まります。式(1)から、第1項である$x_1$は、$q \neq 0$ですから、

$$
x_1 = - \frac{1}{q}x_3 - \frac{p}{q}x_2 \tag{7}
$$

のように求めることができますし、第4項以降については先ほどと同様にすべての項を決めることができます。つまり、「$x_2$と$x_3$の値が決まっている」という条件の下でも、式(1)を満たす数列はただ一つに決めることができます。同様に、第5項と第6項の値を決めたり、第1000項と第1001項の値を決めたりしても、式(1)を満たす解はただ一つに決まります。
つまり、任意の自然数$k$に対して、「$x_k$と$x_{k+1}$の値が決まっている」という条件のもとで、式(1)の解をただ一つに定めることができます。
この「$x_k$と$x_{k+1}$の値が決まっている」という条件を、式(1)の**境界条件**といいます。境界条件を決めると式(1)の解は一つに定まる、というわけです。前述した初期条件は境界条件の特別な場合といえます。
逆に、式(1)を満たす解が1つ見つかったとします。その第$k$項と第$k+1$項を見た時、例えば$x_k=1$、$x_{k+1} = 2$であったとしたら、「この解は境界条件$x_k=1$、$x_{k+1}=2$の下での式(1)の解である」とわかります。
要するに、次のことが言えます。

----

隣り合う2つの項$x_k$と$x_{k+1}$の値は、式(1)の解と1対1対応する。すなわち、式(1)のすべての解の一般項は

$$
x_n = f(n, x_k, x_{k+1}) \tag{8}
$$

の形に表すことができる。

----

:::details ちなみに...
上記の「隣り合う」という条件は、解を一つに決めるうえで重要です。例えば$x_1$と$x_3$のように、隣り合っていない二つの項の値を決めたとします。このとき、$p \neq 0$であれば、

$$
x_2 = -\frac{1}{p}x_3 - \frac{q}{p}x_1 \tag{9}
$$

のように $x_2$ の値が決まり、その他の項の値も決めることができます。しかし、$p = 0$のときは式(9)は成立せず、$x_2$の値は決まりません($x_2$は任意の値をとれます)。つまり、隣り合っていない２つの項の値を決めても、それを満たす数列が1つに決まるとは限りません。
:::

今導いた、「隣り合う二つの項の値を決めると、式(1)の解はただ一つに定まる」という主張を、を大胆に解釈してみます(おそらくここが本記事でもっともガバガバなポイントです)。
解を一つに定めるためには、隣り合う二つの項の値を決めてあげればよいわけですが、隣り合っていればどの2項を選んでもよいですし、その値も自由です。このように考えると、「隣り合う項の値を決める」というよりは、「数列に対して何かしら2つの値を決める」ことが、解を一つに決めるために重要であると考えることができる気がします。2つの値を与えると、それに対応する解を一つに決めることができそうです。
逆に、式(1)を満たす解があった時、隣り合う２つの項を見てあげれば、それがどんな境界条件のもとでの解なのかをすぐに求めることができます。同様に、式(1)を満たす解から、与えた2つの値を求めることができそうです。

まとめると、自由に決めることができる定数(任意定数といいます)2つと、式(1)を満たす解のあいだに、1対1の対応を与えることができるのではないか、と予想できます。
つまりこういうことです。

----

任意定数$C_1, C_2$と式(1)の解は1対1対応する。すなわち、式(1)のすべての解の一般項は、

$$
x_n = f(n, C_1, C_2) \tag{10}
$$

の形にあらわすことができる。

----

この予想は実際に正しく、すべての解は$x_n = f(n, C_1, C_2)$の形で一意的に表すことができます。

:::details 補足
$x_n = f(n, C_1, C_2)$のような書き方は、異なる定数に対して同じ解が出てくること、つまり、

$$
f(n, C_1, C_2) = f(n, K_1, K_2), \quad ((C_1, C_2) \neq (K_1, K_2)) \tag{8}
$$

となることを認めているように見えますが、このようなことはありません。すなわち、

$$
(C_1, C_2) \neq (K_1, K_2) \Leftrightarrow f(n, C_1, C_2) \neq f(n, K_1, K_2) \tag{9}
$$

が成立します。すべての解が$x_n = f(n, C_1, C_2)$の形で**一意的に**あらわせるとは、このことを意味します。

:::

$x_n = f(n, C_1, C_2)$のように、式(1)を満たす解を、任意定数を用いて表したものを、式(1)の**一般解**といいます。
この章で分かったのは、式(1)の一般解は、任意定数2つで表すことができる、ということです。

## 特殊解の線形性

# 2つの特殊解を見つける

## 特性方程式

## 特性方程式が2つの相異なる実数解をもつ場合

## 特性方程式が重解を持つ場合

## 特性方程式が2つの相異なる複素数解をもつ場合

# 微分方程式との関連

# まとめ

[^1]: 広田良悟・高橋大輔: 差分と超離散, p17, 共立出版(2020)